<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lamisha Bakehouse - Artisanal Cookies & Cakes</title>
    <meta name="description"
        content="Kukis dan kue premium yang dipanggang segar setiap hari. Rasakan kemewahan dalam setiap gigitan.">

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Leaflet.js CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <style>
        :root {
            --primary-color: #b02762;
            --secondary-color: #d4a017;
            --accent-color: #ff85a1;
            --bg-color: #fff2f6;
            --text-color: #3d0a1f;
            --text-muted: #8c4b66;
            --white: #ffffff;
            --spacing-md: 16px;
            --font-serif: 'Playfair Display', serif;
            --font-sans: 'Lato', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-md);
        }

        /* Navbar */
        .navbar {
            padding: var(--spacing-md) 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            background: rgba(255, 242, 246, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(176, 39, 98, 0.1);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: var(--font-serif);
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .nav-icons {
            display: flex;
            gap: 20px;
            color: var(--primary-color);
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -10px;
            background: var(--secondary-color);
            color: #fff;
            font-size: 0.7rem;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Hero */
        .hero {
            height: 60vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            background: linear-gradient(rgba(176, 39, 98, 0.1), rgba(176, 39, 98, 0.1)), url('https://images.unsplash.com/photo-1499636136210-6f4ee915583e?auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            color: var(--white);
        }

        .hero-content h1 {
            font-family: var(--font-serif);
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        /* Cart Drawer */
        .cart-drawer {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100%;
            background: #fff;
            z-index: 1001;
            transition: 0.3s;
            padding: 20px;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }

        .cart-drawer.active {
            right: 0;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .close-cart {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-muted);
        }

        .cart-items {
            flex-grow: 1;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f9f9f9;
        }

        .cart-footer {
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        /* Location Section */
        .cart-location-section {
            padding: 15px;
            background: #fdf2f5;
            border-radius: 8px;
            margin: 15px 0;
        }

        .cart-location-section h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .location-help {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        #map {
            height: 180px;
            width: 100%;
            border-radius: 6px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            z-index: 1;
        }

        .btn-location-me {
            width: 100%;
            padding: 8px;
            background: #fff;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: 0.3s;
        }

        .btn-location-me:hover {
            background: var(--primary-color);
            color: #fff;
        }

        .location-status {
            margin-top: 10px;
            padding: 8px;
            background: #fff;
            font-size: 0.75rem;
            border-left: 3px solid var(--secondary-color);
            border-radius: 3px;
        }

        .btn {
            padding: 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 700;
            text-transform: uppercase;
            width: 100%;
            transition: 0.3s;
        }

        .btn-primary {
            background: var(--primary-color);
            color: #fff;
        }

        .btn-primary:hover {
            background: #8e1f50;
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
        }

        .cart-overlay.active {
            display: block;
        }

        @media (max-width: 480px) {
            .cart-drawer {
                width: 100%;
                right: -100%;
            }
        }
    </style>
</head>

<body>
    <nav class="navbar">
        <div class="container nav-container">
            <div class="logo">LA MISHA</div>
            <div class="nav-icons">
                <div class="cart-icon" onclick="toggleCart()">
                    <i class="fas fa-shopping-bag"></i>
                    <span class="cart-count" id="cartCount">1</span>
                </div>
            </div>
        </div>
    </nav>

    <header class="hero">
        <div class="hero-content">
            <h1>Lamisha Bakehouse</h1>
            <p>Kukis Premium Metro, Lampung</p>
        </div>
    </header>

    <div id="cartDrawer" class="cart-drawer">
        <div class="cart-header">
            <h3>Pemesanan</h3>
            <button class="close-cart" onclick="toggleCart()">&times;</button>
        </div>

        <div id="cartItems" class="cart-items">
            <!-- Mock Item for Demonstration -->
            <div class="cart-item">
                <div>
                    <h4>Signature Nastar Gold (1/2Kg)</h4>
                    <p>1 x Rp 110.000</p>
                </div>
            </div>
        </div>

        <div class="cart-location-section" id="locationSection">
            <h4>üìç Lokasi Pengiriman</h4>
            <p class="location-help">Klik pada peta untuk tentukan titik antar</p>
            <div id="map"></div>
            <button class="btn-location-me" onclick="useCurrentLocation()">
                <i class="fas fa-location-crosshairs"></i> Gunakan Lokasi Saya
            </button>
            <div id="locationStatus" class="location-status">Belum ada lokasi terpilih</div>
            <input type="hidden" id="coords">
            <input type="hidden" id="distance">
        </div>

        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cartTotal">Rp 110.000</span>
            </div>
            <button class="btn btn-primary" onclick="checkoutToWhatsApp()">
                <i class="fab fa-whatsapp"></i> Pesan via WhatsApp
            </button>
        </div>
    </div>

    <div id="cartOverlay" class="cart-overlay" onclick="toggleCart()"></div>

    <!-- Leaflet.js JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        let map;
        let marker;
        const shopLocation = [-5.154633, 105.300084]; // Metro, Lampung updated lokasi
        const cart = [{ name: "Signature Nastar Gold (1/2Kg)", price: 110000, quantity: 1 }];

        function toggleCart() {
            const drawer = document.getElementById('cartDrawer');
            const overlay = document.getElementById('cartOverlay');
            drawer.classList.toggle('active');
            overlay.classList.toggle('active');

            if (drawer.classList.contains('active')) {
                setTimeout(initMap, 300);
            }
        }

        function initMap() {
            if (map) {
                map.invalidateSize();
                return;
            }

            map = L.map('map').setView(shopLocation, 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap'
            }).addTo(map);

            map.on('click', function (e) {
                setMarker(e.latlng);
            });
        }

        function setMarker(latlng) {
            if (marker) {
                marker.setLatLng(latlng);
            } else {
                marker = L.marker(latlng).addTo(map);
            }

            const lat = latlng.lat;
            const lng = latlng.lng;
            document.getElementById('coords').value = `${lat},${lng}`;

            // Calculate distance
            const shopLatLng = L.latLng(shopLocation);
            const distMeter = shopLatLng.distanceTo(latlng);
            const distKm = (distMeter / 1000).toFixed(2);
            document.getElementById('distance').value = distKm;

            document.getElementById('locationStatus').innerText = `Terpilih: ${lat.toFixed(4)}, ${lng.toFixed(4)} (${distKm} km)`;
        }

        function useCurrentLocation() {
            if (!navigator.geolocation) {
                alert("Geolocation tidak didukung browser ini.");
                return;
            }

            const status = document.getElementById('locationStatus');
            status.innerText = "Mencari lokasi... (Mohon tunggu)";

            const geoOptions = {
                enableHighAccuracy: true,
                timeout: 8000,
                maximumAge: 60000
            };

            navigator.geolocation.getCurrentPosition((pos) => {
                const latlng = { lat: pos.coords.latitude, lng: pos.coords.longitude };
                map.setView(latlng, 15);
                setMarker(latlng);
            }, (err) => {
                if (err.code === err.TIMEOUT || err.code === err.PERMISSION_DENIED) {
                    status.innerText = "Mencoba metode cepat...";
                    navigator.geolocation.getCurrentPosition((pos) => {
                        const latlng = { lat: pos.coords.latitude, lng: pos.coords.longitude };
                        map.setView(latlng, 15);
                        setMarker(latlng);
                    }, (error) => {
                        alert("Gagal: " + error.message);
                        status.innerText = "Gagal ambil lokasi.";
                    }, { enableHighAccuracy: false, timeout: 5000 });
                } else {
                    alert("Gagal: " + err.message);
                    status.innerText = "Gagal ambil lokasi.";
                }
            }, geoOptions);
        }


        function checkoutToWhatsApp() {
            const koordinat = document.getElementById('coords').value;
            const jarak = document.getElementById('distance').value;

            if (!koordinat) {
                alert("Pilih lokasi pengiriman di peta dulu!");
                return;
            }

            let message = "*Halo Lamisha Bakehouse, saya ingin memesan:*\n\n";
            cart.forEach((item, i) => {
                message += `${i + 1}. *${item.name}* (x${item.quantity})\n`;
            });

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            message += `\n*Total Harga: Rp ${total.toLocaleString('id-ID')}*\n`;
            message += `*Jarak: ${jarak} km*\n`;
            message += `*Link Lokasi:* https://www.google.com/maps?q=${koordinat}`;

            const url = `https://wa.me/6285836695103?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }
    </script>
</body>

</html>